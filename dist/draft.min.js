!function t(e,n,r){function i(u,a){if(!n[u]){if(!e[u]){var o="function"==typeof require&&require;if(!a&&o)return o(u,!0);if(s)return s(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[u]={exports:{}};e[u][0].call(l.exports,function(t){var n=e[u][1][t];return i(n?n:t)},l,l.exports,t,e,n,r)}return n[u].exports}for(var s="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(t){"use strict";var e=function(t){return t&&t.__esModule?t["default"]:t},n=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=e(t("./dispatcher/Dispatcher.js")),s=e(t("./dispatcher/Events.js")),u=e(t("./components/shape/Rectangle.js")),a=e(t("./helpers/Zed.js")),o=function(){function t(e){var n=this;r(this,t),this.shapes=[],this.index=1,this.keyboard={multiSelect:!1,aspectRatio:!1},this.options=this.getOptions(),this.dispatcher=new i,function(t){t.bind("mod+a",function(){return n.dispatcher.send(s.SELECT_ALL)}),t.bind("mod",function(){return n.keyboard.multiSelect=!0},"keydown"),t.bind("mod",function(){return n.keyboard.multiSelect=!1},"keyup"),t.bind("shift",function(){return n.keyboard.aspectRatio=!0},"keydown"),t.bind("shift",function(){return n.keyboard.aspectRatio=!1},"keyup")}(Mousetrap||{bind:function(){}}),this.svg=d3.select("string"==typeof e?document.querySelector(e):e).attr("width",this.options.documentWidth).attr("height",this.options.documentHeight).on("click",function(){return n.dispatcher.send(s.DESELECT_ALL)}),this.groups={shapes:this.svg.append("g").attr("class","shapes").on("click",function(){return d3.event.stopPropagation()}),handles:this.svg.append("g").attr("class","handles").on("click",function(){return d3.event.stopPropagation()})}}return n(t,{add:{value:function(t){var e=this.getInstance(t),n=e.getFacade();return this.shapes.push(n),n}},remove:{value:function(t){t.remove()}},getSelected:{value:function(){return this.shapes.filter(function(t){return t.isSelected()})}},getAccessor:{value:function(){var t=this;return{getSelected:this.getSelected.bind(this),groups:this.groups,selectAll:function(){return t.dispatcher.send(s.SELECT_ALL)},deselectAll:function(){return t.dispatcher.send(s.DESELECT_ALL)},reorder:function(e){var n=t.svg.selectAll("g.shapes g");a.reorder(n,e)}}}},getInstance:{value:function(t){var e={rect:u},n=new(e[t.toLowerCase()]);return n.setAccessor(this.getAccessor()),n.setDispatcher(this.dispatcher),n.insert(this.groups.shapes,this.index++),n}},getOptions:{value:function(){return{documentHeight:"100%",documentWidth:"100%",gridSize:10}}}}),t}();!function(t){t.Draft=o}(window)},{"./components/shape/Rectangle.js":5,"./dispatcher/Dispatcher.js":7,"./dispatcher/Events.js":8,"./helpers/Zed.js":9}],2:[function(t,e){"use strict";var n=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(e){r(this,t),this.shape=e,this.selected=!1}return n(t,{select:{value:function(){this.shape.features.selectable.select(),this.selected=!0}},deselect:{value:function(){this.shape.features.selectable.deselect(),this.selected=!1}},invert:{value:function(){this.selected=!this.selected}},attribute:{value:function(t){var e=void 0===arguments[1]?null:arguments[1];return"z"===t?this.z(e):null===e?this.shape.element.datum()[t]:(this.shape.element.datum()[t]=e,this.shape.element.attr(t,e),this)}},transform:{value:function(){var t=void 0===arguments[0]?null:arguments[0],e=void 0===arguments[1]?null:arguments[1];return null===t&&null===e?[this.x(),this.y()]:this.attribute("transform","translate("+t+", "+e+")")}},x:{value:function(t){var e=function(){return t.apply(this,arguments)};return e.toString=function(){return t.toString()},e}(function(){var t=void 0===arguments[0]?null:arguments[0];return null===t?this.parseTranslate(this.shape.element.datum().transform).x:this.transform(t,this.y())})},y:{value:function(t){var e=function(){return t.apply(this,arguments)};return e.toString=function(){return t.toString()},e}(function(){var t=void 0===arguments[0]?null:arguments[0];return null===t?this.parseTranslate(this.shape.element.datum().transform).y:this.transform(this.x(),t)})},z:{value:function(t){var e=function(){return t.apply(this,arguments)};return e.toString=function(){return t.toString()},e}(function(){var t=void 0===arguments[0]?null:arguments[0];return null===t?this.shape.group.datum().z:this.shape.group.datum().z=t})},dimension:{value:function(){var t=void 0===arguments[0]?null:arguments[0],e=void 0===arguments[1]?null:arguments[1];return null===t&&null===e?[this.height(),this.width()]:this.height(t).width(e)}},height:{value:function(t){var e=function(){return t.apply(this,arguments)};return e.toString=function(){return t.toString()},e}(function(){var t=void 0===arguments[0]?null:arguments[0];return this.attribute("height",t)})},width:{value:function(t){var e=function(){return t.apply(this,arguments)};return e.toString=function(){return t.toString()},e}(function(){var t=void 0===arguments[0]?null:arguments[0];return this.attribute("width",t)})},bringToFront:{value:function(){return this.attribute("z",1/0),this.shape.accessor.reorder(this.shape.group),this}},bringForwards:{value:function(){return this.attribute("z",this.attribute("z")+1),this.shape.accessor.reorder(this.shape.group),this}},sendToBack:{value:function(){return this.attribute("z",-1/0),this.shape.accessor.reorder(this.shape.group),this}},sendBackwards:{value:function(){return this.attribute("z",this.attribute("z")-1),this.shape.accessor.reorder(this.shape.group),this}},getShape:{value:function(){return this.shape}},parseTranslate:{value:function(t){var e=String(t).match(/translate\(([0-9]+)\s*,\s*([0-9]+)/i);return{x:parseInt(e[1]),y:parseInt(e[2])}}},isSelected:{value:function(){return this.selected}}}),t}();e.exports=i},{}],3:[function(t,e){"use strict";var n=function(t){return t&&t.__esModule?t["default"]:t},r=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=n(t("./shape/feature/Selectable.js")),u=n(t("./../dispatcher/Events.js")),a=function(){function t(){i(this,t),this.features={selectable:new s(this)}}return r(t,{getName:{value:function(){return this.getTag()}},insert:{value:function(t){var e=void 0===arguments[1]?0:arguments[1];this.group=t.append("g").attr("class","shape "+this.getName()).datum({z:e}),this.element=this.group.append(this.getTag()).datum({transform:"translate(0,0)"})}},getFacade:{value:function(){return this.facade}},setAccessor:{value:function(t){this.accessor=t}},setDispatcher:{value:function(t){var e=this;this.dispatcher=t,t.on(u.SELECT_ALL,function(){return e.getFacade().select()}),t.on(u.DESELECT_ALL,function(){return e.getFacade().deselect()})}}}),t}();e.exports=a},{"./../dispatcher/Events.js":8,"./shape/feature/Selectable.js":6}],4:[function(t,e){"use strict";var n=function(t){return t&&t.__esModule?t["default"]:t},r=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},s=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},u=n(t("./../Facade.js")),a=function(t){function e(){s(this,e),null!=t&&t.apply(this,arguments)}return i(e,t),r(e,{fill:{value:function(t){return this.attribute("fill",t)}}}),e}(u);e.exports=a},{"./../Facade.js":2}],5:[function(t,e){"use strict";var n=function(t){return t&&t.__esModule?t["default"]:t},r=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function l(t,e,n){var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:l(i,e,n)}if("value"in r&&r.writable)return r.value;var s=r.get;return void 0===s?void 0:s.call(n)},s=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},u=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=n(t("./../Shape.js")),o=n(t("./../facade/Rectangle.js")),c=function(t){function e(){u(this,e),i(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this.facade=new o(this)}return s(e,t),r(e,{getTag:{value:function(){return"rect"}}}),e}(a);e.exports=c},{"./../Shape.js":3,"./../facade/Rectangle.js":4}],6:[function(t,e){"use strict";var n=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(e){r(this,t),this.shape=e}return n(t,{select:{value:function(){console.log("Here"),this.shape.selected=!0}},deselect:{value:function(){this.shape.selected=!1}}}),t}();e.exports=i},{}],7:[function(t,e){"use strict";var n=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(){r(this,t),this.events=[]}return n(t,{send:{value:function(t){this.events.hasOwnProperty(t)&&this.events[t].forEach(function(t){return t()})}},on:{value:function(t,e){this.events.hasOwnProperty(t)||(this.events[t]=[]),this.events[t].push(e)}}}),t}();e.exports=i},{}],8:[function(t,e){"use strict";e.exports={SELECT_ALL:"select-all",DESELECT_ALL:"deselect"}},{}],9:[function(t,e){"use strict";e.exports={reorder:function(t,e){var n=t.size();e.datum().z<1&&(e.datum().z=1),e.datum().z>n&&(e.datum().z=n);var r=e.datum().z,i=1;t.sort(function(t,e){return t.z-e.z}),t[0].forEach(function(t){if(t!==e.node()){i===r&&i++;var n=d3.select(t),s=n.datum();s.z=i++,n.datum(s)}}),t.sort(function(t,e){return t.z-e.z})}}},{}]},{},[1]);