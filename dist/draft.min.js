!function e(t,n,r){function u(i,o){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!o&&l)return l(i,!0);if(a)return a(i,!0);var s=new Error("Cannot find module '"+i+"'");throw s.code="MODULE_NOT_FOUND",s}var f=n[i]={exports:{}};t[i][0].call(f.exports,function(e){var n=t[i][1][e];return u(n?n:e)},f,f.exports,e,t,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)u(r[i]);return u}({1:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./helpers/Middleman"),o=r(i),l=e("./helpers/Symbols"),s=r(l),f=e("./helpers/BoundingBox"),c=r(f),d=e("./helpers/Polyfills"),h=e("./helpers/Invocator"),p=r(h),v=e("./helpers/Mapper"),y=r(v),m=function(){function e(t){var n=this,r=void 0===arguments[1]?{}:arguments[1];u(this,e),this[s["default"].SHAPES]=[],this[s["default"].OPTIONS]=(Object.assign||d.objectAssign)(this.options(),r);var a=this[s["default"].MIDDLEMAN]=new o["default"](this);this[s["default"].BOUNDING_BOX]=new c["default"](a);var i=this[s["default"].OPTIONS].documentWidth,l=this[s["default"].OPTIONS].documentHeight,f=this[s["default"].SVG]=d3.select(t).attr("width",i).attr("height",l),h=function(){return d3.event.stopPropagation()};this[s["default"].LAYERS]={shapes:f.append("g").attr("class","shapes").on("click",h),markers:f.append("g").attr("class","markers").on("click",h)},f.on("click",function(){a.preventDeselect()||n.deselect(),a.preventDeselect(!1)})}return a(e,[{key:"add",value:function(e){e="string"==typeof e?y["default"](e):e;var t=this[s["default"].SHAPES];return t.push(e),e[s["default"].MIDDLEMAN]=this[s["default"].MIDDLEMAN],p["default"].did("add",e),e}},{key:"remove",value:function(e){var t=this[s["default"].SHAPES],n=t.indexOf(e);return t.splice(n,1),p["default"].did("remove",e),t.length}},{key:"clear",value:function(){var e=this[s["default"].SHAPES];return p["default"].did("remove",e),e.length=0,e.length}},{key:"all",value:function(){return this[s["default"].SHAPES]}},{key:"select",value:function(){var e=void 0===arguments[0]?this.all():arguments[0];p["default"].did("select",e),this[s["default"].BOUNDING_BOX].drawBoundingBox(this.selected(),this[s["default"].LAYERS].markers)}},{key:"deselect",value:function(){var e=void 0===arguments[0]?this.all():arguments[0];p["default"].did("deselect",e),this[s["default"].BOUNDING_BOX].drawBoundingBox(this.selected(),this[s["default"].LAYERS].markers)}},{key:"selected",value:function(){return this.all().filter(function(e){return e.isSelected()})}},{key:"options",value:function(){return this[s["default"].OPTIONS]||{documentHeight:"100%",documentWidth:"100%",gridSize:10}}}]),e}();!function(e){e&&(e.Draft=m)}(window),n["default"]=m,t.exports=n["default"]},{"./helpers/BoundingBox":5,"./helpers/Invocator":6,"./helpers/Mapper":8,"./helpers/Middleman":9,"./helpers/Polyfills":10,"./helpers/Symbols":11}],2:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../helpers/Symbols"),o=r(i),l=function(){function e(){u(this,e)}return a(e,[{key:"shape",value:function(){return this[o["default"].SHAPE]}},{key:"middleman",value:function(){return this.shape()[o["default"].MIDDLEMAN]}}]),e}();n["default"]=l,t.exports=n["default"]},{"../helpers/Symbols":11}],3:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e,t,n){for(var r=!0;r;){var u=e,a=t,i=n;o=s=l=void 0,r=!1,null===u&&(u=Function.prototype);var o=Object.getOwnPropertyDescriptor(u,a);if(void 0!==o){if("value"in o)return o.value;var l=o.get;return void 0===l?void 0:l.call(i)}var s=Object.getPrototypeOf(u);if(null===s)return void 0;e=s,t=a,n=i,r=!0}},l=e("./Ability"),s=r(l),f=e("./../helpers/Symbols"),c=r(f),d=function(e){function t(){u(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),i(t,[{key:"didAdd",value:function(){var e=this.shape()[c["default"].ELEMENT];e.on("click",this.handleClick.bind(this))}},{key:"handleClick",value:function(){var e=this.middleman()[c["default"].KEY_MAP];return this.shape().isSelected()?e.multiSelect?void this.middleman().deselect({include:this.shape()}):void this.middleman().deselect({exclude:this.shape()}):(e.multiSelect||this.middleman().deselect({exclude:this.shape()}),void this.middleman().select({include:this.shape()}))}}]),t}(s["default"]);n["default"]=d,t.exports=n["default"]},{"./../helpers/Symbols":11,"./Ability":2}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e,t,n){switch(t){case"x":var r=e.datum().y||0;return void e.attr("transform","translate("+n+", "+r+")");case"y":var u=e.datum().x||0;return void e.attr("transform","translate("+u+", "+n+")")}e.attr(t,n)},t.exports=n["default"]},{}],5:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("./Symbols"),l=r(o),s=function(){function e(t){a(this,e),this[l["default"].MIDDLEMAN]=t}return i(e,[{key:"handleClick",value:function(){var e=this[l["default"].MIDDLEMAN];if(d3.event.stopPropagation(),e.preventDeselect())return void e.preventDeselect(!1);var t=d3.event.pageX,n=d3.event.pageY;this.bBox.attr("pointer-events","none");var r=document.elementFromPoint(t,n);if(this.bBox.attr("pointer-events","all"),e.fromElement(r)){var u=new MouseEvent("click",{bubbles:!0,cancelable:!1});r.dispatchEvent(u)}}},{key:"drawBoundingBox",value:function(e,t){var n,r,a,i=this;if(this.bBox&&this.bBox.remove(),0!==e.length){var o={minX:Number.MAX_VALUE,minY:Number.MAX_VALUE,maxX:Number.MIN_VALUE,maxY:Number.MIN_VALUE},l=function(e){o.minX=Math.min.apply(Math,u(e.map(function(e){return e.x}))),o.minY=Math.min.apply(Math,u(e.map(function(e){return e.y}))),o.maxX=Math.max.apply(Math,u(e.map(function(e){return e.x+e.width}))),o.maxY=Math.max.apply(Math,u(e.map(function(e){return e.y+e.height})))};l(e.map(function(e){return e.boundingBox()})),this.bBox=t.append("rect").datum(o).classed("drag-box",!0).attr("x",function(e){return e.minX}).attr("y",function(e){return e.minY}).attr("width",function(e){return e.maxX-e.minX}).attr("height",function(e){return e.maxY-e.minY}).on("click",this.handleClick.bind(this));var s=["dragstart",function(){return i.dragStart()}],f=["drag",function(){return i.drag()}],c=["dragend",function(){return i.dragEnd()}];this.bBox.call((n=(r=(a=d3.behavior.drag()).on.apply(a,s)).on.apply(r,f)).on.apply(n,c))}}},{key:"dragStart",value:function(){var e=void 0===arguments[0]?null:arguments[0],t=void 0===arguments[1]?null:arguments[1];this.start={x:null!==e?e:d3.event.sourceEvent.clientX-parseInt(this.bBox.attr("x")),y:null!==t?t:d3.event.sourceEvent.clientY-parseInt(this.bBox.attr("y"))}}},{key:"drag",value:function(){var e=void 0===arguments[0]?null:arguments[0],t=void 0===arguments[1]?null:arguments[1],n=void 0===arguments[2]?this[l["default"].MIDDLEMAN].options().gridSize:arguments[2];this[l["default"].MIDDLEMAN].preventDeselect(!0),e=null!==e?e:d3.event.sourceEvent.clientX,t=null!==t?t:d3.event.sourceEvent.clientY;var r=e-this.start.x,u=t-this.start.y,a=Math.ceil(r/n)*n,i=Math.ceil(u/n)*n;this.bBox.datum().x=a,this.bBox.attr("x",a),this.bBox.datum().y=i,this.bBox.attr("y",i)}},{key:"dragEnd",value:function(){}}]),e}();n["default"]=s,t.exports=n["default"]},{"./Symbols":11}],6:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var u=e("./Symbols"),a=r(u),i=function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),u=2;n>u;u++)r[u-2]=arguments[u];return"function"==typeof e[t]?(e[t].apply(e,r),!0):!1},o=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};n["default"]=function(){return{did:function(e,t){return t=Array.isArray(t)?t:[t],t.every(function(t){return i(t,"did"+o(e))})},includeExclude:function(e,t){var n=void 0===arguments[2]?{}:arguments[2],r=n.include||void 0,u=n.exclude||void 0,i=e[a["default"].MIDDLEMAN],o=function(e){return e=Array.isArray(e)?e:[e],i.all().filter(function(t){return!~e.indexOf(t)})};return r?void t.apply(e,[r]):u?void t.apply(e,[o(u)]):void t.apply(e)}}}(),t.exports=n["default"]},{"./Symbols":11}],7:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./Symbols"),o=r(i),l=function(){function e(t){u(this,e);var n=t[o["default"].KEY_MAP];this[o["default"].MIDDLEMAN]=t,n.multiSelect=!1,n.aspectRatio=!1,this.attachBindings(n)}return a(e,[{key:"attachBindings",value:function(e){var t=this;Mousetrap.bind("mod+a",function(){return t[o["default"].MIDDLEMAN].select()}),Mousetrap.bind("mod",function(){return e.multiSelect=!0},"keydown"),Mousetrap.bind("mod",function(){return e.multiSelect=!1},"keyup"),Mousetrap.bind("shift",function(){return e.aspectRatio=!0},"keydown"),Mousetrap.bind("shift",function(){return e.aspectRatio=!1},"keyup")}}]),e}();n["default"]=l,t.exports=n["default"]},{"./Symbols":11}],8:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var u=e("../helpers/Throw"),a=r(u),i=e("../shapes/Rectangle"),o=r(i);n["default"]=function(e){var t={rectangle:o["default"]};return"undefined"!=typeof t[e]?new t[e]:new a["default"]('Cannot map "'+e+'" to a shape object')},t.exports=n["default"]},{"../helpers/Throw":12,"../shapes/Rectangle":13}],9:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./Symbols"),o=r(i),l=e("./KeyBindings"),s=r(l),f=e("./Invocator"),c=r(f),d=function(){function e(t){u(this,e),this[o["default"].DRAFT]=t,this[o["default"].KEY_MAP]={},this[o["default"].CAN_DESELECT]=!1,new s["default"](this)}return a(e,[{key:"d3",value:function(){return this[o["default"].DRAFT][o["default"].SVG]}},{key:"layers",value:function(){return this[o["default"].DRAFT][o["default"].LAYERS]}},{key:"options",value:function(){return this[o["default"].DRAFT].options()}},{key:"keyMap",value:function(){return this[o["default"].KEY_MAP]}},{key:"select",value:function(e){c["default"].includeExclude(this[o["default"].DRAFT],this[o["default"].DRAFT].select,e)}},{key:"deselect",value:function(e){c["default"].includeExclude(this[o["default"].DRAFT],this[o["default"].DRAFT].deselect,e)}},{key:"all",value:function(){return this[o["default"].DRAFT].all()}},{key:"fromElement",value:function(e){return this.all().filter(function(t){return e===t[o["default"].ELEMENT].node()})[0]}},{key:"preventDeselect",value:function(e){return"undefined"==typeof e?this[o["default"].CAN_DESELECT]:void(this[o["default"].CAN_DESELECT]=e)}}]),e}();n["default"]=d,t.exports=n["default"]},{"./Invocator":6,"./KeyBindings":7,"./Symbols":11}],10:[function(e,t,n){"use strict";function r(e){if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(void 0!==r&&null!==r){r=Object(r);for(var u=Object.keys(Object(r)),a=0,i=u.length;i>a;a++){var o=u[a],l=Object.getOwnPropertyDescriptor(r,o);void 0!==l&&l.enumerable&&(t[o]=r[o])}}}return t}Object.defineProperty(n,"__esModule",{value:!0}),n.objectAssign=r},{}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]={DRAFT:Symbol("draft"),SVG:Symbol("svg"),ELEMENT:Symbol("element"),IS_SELECTED:Symbol("isSelected"),ATTRIBUTES:Symbol("attributes"),MIDDLEMAN:Symbol("middleman"),SHAPE:Symbol("shape"),SHAPES:Symbol("shapes"),LAYERS:Symbol("layers"),GROUP:Symbol("group"),BOUNDING_BOX:Symbol("boundingBox"),OPTIONS:Symbol("options"),ABILITIES:Symbol("abilities"),KEY_MAP:Symbol("keyMap"),CAN_DESELECT:Symbol("canDeselect")},t.exports=n["default"]},{}],12:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var u=function a(e){throw r(this,a),new Error("Draft.js: "+e+".")};n["default"]=u,t.exports=n["default"]},{}],13:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e,t,n){for(var r=!0;r;){var u=e,a=t,i=n;o=s=l=void 0,r=!1,null===u&&(u=Function.prototype);var o=Object.getOwnPropertyDescriptor(u,a);if(void 0!==o){if("value"in o)return o.value;var l=o.get;return void 0===l?void 0:l.call(i)}var s=Object.getPrototypeOf(u);if(null===s)return void 0;e=s,t=a,n=i,r=!0}},l=e("./Shape"),s=r(l),f=function(e){function t(){u(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),i(t,[{key:"tagName",value:function(){return"rect"}},{key:"defaultAttributes",value:function(){return{fill:"blue",height:100,width:100,x:0,y:0}}}]),t}(s["default"]);n["default"]=f,t.exports=n["default"]},{"./Shape":14}],14:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../helpers/Symbols"),o=r(i),l=e("../abilities/Selectable"),s=r(l),f=e("../helpers/Throw"),c=r(f),d=e("../helpers/Polyfills"),h=e("../helpers/Attributes"),p=r(h),v=e("../helpers/Invocator"),y=r(v),m=function(){function e(){var t=void 0===arguments[0]?{}:arguments[0];u(this,e),this[o["default"].ATTRIBUTES]=t}return a(e,[{key:"tagName",value:function(){new c["default"]("Tag name must be defined for a shape using the `tagName` method")}},{key:"isSelected",value:function(){return this[o["default"].IS_SELECTED]}},{key:"attr",value:function(e,t){return"undefined"==typeof t?this[o["default"].ELEMENT].datum()[e]:(this[o["default"].ELEMENT].datum()[e]=t,p["default"](this[o["default"].ELEMENT],e,t),this)}},{key:"didAdd",value:function(){var e=this,t=this[o["default"].MIDDLEMAN].layers().shapes,n=d.objectAssign(this.defaultAttributes(),this[o["default"].ATTRIBUTES]);this[o["default"].GROUP]=t.append("g"),this[o["default"].ELEMENT]=this[o["default"].GROUP].append(this.tagName()).datum({}),Object.keys(n).forEach(function(t){return e.attr(t,n[t])});var r={selectable:new s["default"]};Object.keys(r).forEach(function(t){var n=r[t];n[o["default"].SHAPE]=e,y["default"].did("add",n)}),this[o["default"].ABILITIES]=r}},{key:"didRemove",value:function(){}},{key:"didSelect",value:function(){this[o["default"].IS_SELECTED]=!0}},{key:"didDeselect",value:function(){this[o["default"].IS_SELECTED]=!1}},{key:"boundingBox",value:function(){var e="function"==typeof this[o["default"].GROUP].node().getBBox;return e?this[o["default"].GROUP].node().getBBox():{height:this.attr("height"),width:this.attr("width"),x:this.attr("x"),y:this.attr("y")}}},{key:"defaultAttributes",value:function(){return{}}}]),e}();n["default"]=m,t.exports=n["default"]},{"../abilities/Selectable":3,"../helpers/Attributes":4,"../helpers/Invocator":6,"../helpers/Polyfills":10,"../helpers/Symbols":11,"../helpers/Throw":12}]},{},[1]);