!function e(t,n,r){function a(o,u){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!u&&l)return l(o,!0);if(i)return i(o,!0);var s=new Error("Cannot find module '"+o+"'");throw s.code="MODULE_NOT_FOUND",s}var d=n[o]={exports:{}};t[o][0].call(d.exports,function(e){var n=t[o][1][e];return a(n?n:e)},d,d.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(e,t,n){!function(e,n,r){function a(e,t,n){return e.addEventListener?void e.addEventListener(t,n,!1):void e.attachEvent("on"+t,n)}function i(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return m[e.which]?m[e.which]:g[e.which]?g[e.which]:String.fromCharCode(e.which).toLowerCase()}function o(e,t){return e.sort().join(",")===t.sort().join(",")}function u(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}function l(e){return e.preventDefault?void e.preventDefault():void(e.returnValue=!1)}function s(e){return e.stopPropagation?void e.stopPropagation():void(e.cancelBubble=!0)}function d(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function c(){if(!b){b={};for(var e in m)e>95&&112>e||m.hasOwnProperty(e)&&(b[m[e]]=e)}return b}function f(e,t,n){return n||(n=c()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function h(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus"),e.split("+"))}function p(e,t){var n,r,a,i=[];for(n=h(e),a=0;a<n.length;++a)r=n[a],x[r]&&(r=x[r]),t&&"keypress"!=t&&E[r]&&(r=E[r],i.push("shift")),d(r)&&i.push(r);return t=f(r,i,t),{key:r,modifiers:i,action:t}}function v(e,t){return null===e||e===n?!1:e===t?!0:v(e.parentNode,t)}function y(e){function t(e){e=e||{};var t,n=!1;for(t in E)e[t]?n=!0:E[t]=0;n||(k=!1)}function r(e,t,n,r,a,i){var u,l,s=[],c=n.type;if(!m._callbacks[e])return[];for("keyup"==c&&d(e)&&(t=[e]),u=0;u<m._callbacks[e].length;++u)if(l=m._callbacks[e][u],(r||!l.seq||E[l.seq]==l.level)&&c==l.action&&("keypress"==c&&!n.metaKey&&!n.ctrlKey||o(t,l.modifiers))){var f=!r&&l.combo==a,h=r&&l.seq==r&&l.level==i;(f||h)&&m._callbacks[e].splice(u,1),s.push(l)}return s}function c(e,t,n,r){m.stopCallback(t,t.target||t.srcElement,n,r)||e(t,n)===!1&&(l(t),s(t))}function f(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=i(e);if(t)return"keyup"==e.type&&x===t?void(x=!1):void m.handleKey(t,u(e),e)}function h(){clearTimeout(g),g=setTimeout(t,1e3)}function v(e,n,r,a){function o(t){return function(){k=t,++E[e],h()}}function u(n){c(r,n,e),"keyup"!==a&&(x=i(n)),setTimeout(t,10)}E[e]=0;for(var l=0;l<n.length;++l){var s=l+1===n.length,d=s?u:o(a||p(n[l+1]).action);b(n[l],d,a,e,l)}}function b(e,t,n,a,i){m._directMap[e+":"+n]=t,e=e.replace(/\s+/g," ");var o,u=e.split(" ");return u.length>1?void v(e,u,t,n):(o=p(e,n),m._callbacks[o.key]=m._callbacks[o.key]||[],r(o.key,o.modifiers,{type:o.action},a,e,i),void m._callbacks[o.key][a?"unshift":"push"]({callback:t,modifiers:o.modifiers,action:o.action,seq:a,level:i,combo:e}))}var m=this;if(e=e||n,!(m instanceof y))return new y(e);m.target=e,m._callbacks={},m._directMap={};var g,E={},x=!1,M=!1,k=!1;m._handleKey=function(e,n,a){var i,o=r(e,n,a),u={},l=0,s=!1;for(i=0;i<o.length;++i)o[i].seq&&(l=Math.max(l,o[i].level));for(i=0;i<o.length;++i)if(o[i].seq){if(o[i].level!=l)continue;s=!0,u[o[i].seq]=1,c(o[i].callback,a,o[i].combo,o[i].seq)}else s||c(o[i].callback,a,o[i].combo);var f="keypress"==a.type&&M;a.type!=k||d(e)||f||t(u),M=s&&"keydown"==a.type},m._bindMultiple=function(e,t,n){for(var r=0;r<e.length;++r)b(e[r],t,n)},a(e,"keypress",f),a(e,"keydown",f),a(e,"keyup",f)}for(var b,m={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},g={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},E={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},x={option:"alt",command:"meta","return":"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},M=1;20>M;++M)m[111+M]="f"+M;for(M=0;9>=M;++M)m[M+96]=M;y.prototype.bind=function(e,t,n){var r=this;return e=e instanceof Array?e:[e],r._bindMultiple.call(r,e,t,n),r},y.prototype.unbind=function(e,t){var n=this;return n.bind.call(n,e,function(){},t)},y.prototype.trigger=function(e,t){var n=this;return n._directMap[e+":"+t]&&n._directMap[e+":"+t]({},e),n},y.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},y.prototype.stopCallback=function(e,t){var n=this;return(" "+t.className+" ").indexOf(" mousetrap ")>-1?!1:v(t,n.target)?!1:"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},y.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},y.init=function(){var e=y(n);for(var t in e)"_"!==t.charAt(0)&&(y[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},y.init(),e.Mousetrap=y,"undefined"!=typeof t&&t.exports&&(t.exports=y),"function"==typeof define&&define.amd&&define(function(){return y})}(window,document)},{}],2:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("./helpers/Middleman"),u=r(o),l=e("./helpers/Symbols"),s=r(l),d=e("./helpers/BoundingBox"),c=r(d),f=e("./helpers/Polyfills"),h=e("./helpers/Invocator"),p=r(h),v=e("./helpers/Mapper"),y=r(v),b=function(){function e(t){var n=this,r=void 0===arguments[1]?{}:arguments[1];a(this,e),this[s["default"].SHAPES]=[],this[s["default"].OPTIONS]=(Object.assign||f.objectAssign)(this.options(),r);var i=this[s["default"].MIDDLEMAN]=new u["default"](this);this[s["default"].BOUNDING_BOX]=new c["default"](i);var o=this[s["default"].OPTIONS].documentWidth,l=this[s["default"].OPTIONS].documentHeight,d=this[s["default"].SVG]=d3.select(t).attr("width",o).attr("height",l),h=function(){return d3.event.stopPropagation()};this[s["default"].LAYERS]={shapes:d.append("g").attr("class","shapes").on("click",h),boundingBox:d.append("g").attr("class","bounding").on("click",h),resize:d.append("g").attr("class","resize").on("click",h)},d.on("click",function(){i.preventDeselect()||n.deselect(),i.preventDeselect(!1)})}return i(e,[{key:"add",value:function(e){e="string"==typeof e?y["default"](e):e;var t=this[s["default"].SHAPES];return t.push(e),e[s["default"].MIDDLEMAN]=this[s["default"].MIDDLEMAN],p["default"].did("add",e),e}},{key:"remove",value:function(e){var t=this[s["default"].SHAPES],n=t.indexOf(e);return t.splice(n,1),p["default"].did("remove",e),t.length}},{key:"clear",value:function(){var e=this[s["default"].SHAPES];return p["default"].did("remove",e),e.length=0,e.length}},{key:"all",value:function(){return this[s["default"].SHAPES]}},{key:"select",value:function(){var e=void 0===arguments[0]?this.all():arguments[0];p["default"].did("select",e),this[s["default"].BOUNDING_BOX].drawBoundingBox(this.selected(),this[s["default"].LAYERS].boundingBox)}},{key:"deselect",value:function(){var e=void 0===arguments[0]?this.all():arguments[0];p["default"].did("deselect",e),this[s["default"].BOUNDING_BOX].drawBoundingBox(this.selected(),this[s["default"].LAYERS].boundingBox)}},{key:"selected",value:function(){return this.all().filter(function(e){return e.isSelected()})}},{key:"options",value:function(){return this[s["default"].OPTIONS]||{documentHeight:"100%",documentWidth:"100%",gridSize:10,handleRadius:22,defaultMoveStep:1,shiftMoveStep:10}}}]),e}();!function(e){e&&(e.Draft=b)}(window),n["default"]=b,t.exports=n["default"]},{"./helpers/BoundingBox":7,"./helpers/Invocator":8,"./helpers/Mapper":10,"./helpers/Middleman":11,"./helpers/Polyfills":12,"./helpers/Symbols":13}],3:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("../helpers/Symbols"),u=r(o),l=function(){function e(){a(this,e)}return i(e,[{key:"shape",value:function(){return this[u["default"].SHAPE]}},{key:"middleman",value:function(){return this.shape()[u["default"].MIDDLEMAN]}}]),e}();n["default"]=l,t.exports=n["default"]},{"../helpers/Symbols":13}],4:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var a=e,i=t,o=n;u=s=l=void 0,r=!1,null===a&&(a=Function.prototype);var u=Object.getOwnPropertyDescriptor(a,i);if(void 0!==u){if("value"in u)return u.value;var l=u.get;return void 0===l?void 0:l.call(o)}var s=Object.getPrototypeOf(a);if(null===s)return void 0;e=s,t=i,n=o,r=!0}},l=e("./Ability"),s=r(l),d=e("./../helpers/Symbols"),c=r(d),f=function(e){function t(){a(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.edges={}}return i(t,e),o(t,[{key:"didSelect",value:function(){this.RADIUS=this.middleman().options().handleRadius,this.reattachHandles()}},{key:"didDeselect",value:function(){this.detachHandles()}},{key:"reattachHandles",value:function(){this.detachHandles(),this.attachHandles()}},{key:"attachHandles",value:function(){var e=this,t=this.shape(),n=this.middleman().layers().resize;this.layer=n.append("g");var r=t.attr("x"),a=t.attr("y"),i=t.attr("width"),o=t.attr("height"),u={topLeft:{x:r,y:a},topMiddle:{x:r+i/2,y:a},topRight:{x:r+i,y:a},leftMiddle:{x:r,y:a+o/2},bottomLeft:{x:r,y:a+o},bottomMiddle:{x:r+i/2,y:a+o},bottomRight:{x:r+i,y:a+o},rightMiddle:{x:r+i,y:a+o/2}};Object.keys(u).forEach(function(n){var r=u[n],a=e.drag(t,n);e.edges[n]=e.layer.append("image").attr("xlink:href","images/handle-main.png").attr("x",r.x-e.RADIUS/2).attr("y",r.y-e.RADIUS/2).attr("stroke","red").attr("stroke-width",3).attr("width",e.RADIUS).attr("height",e.RADIUS).on("click",function(){return d3.event.stopPropagation()}).call(d3.behavior.drag().on("dragstart",a.start).on("drag",a.drag).on("dragend",a.end))})}},{key:"detachHandles",value:function(){this.layer&&this.layer.remove()}},{key:"popUnique",value:function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];t[r]=t[r]?t[r]+1:1}var a=Object.keys(t).filter(function(e){return 1===t[e]});return a.length?Number(a[0]):e[0]}},{key:"rearrangeHandles",value:function(e){var t=this,n=[],r=/(?=[A-Z])/,a=Object.keys(this.edges);a.forEach(function(e){var r=t.edges[e];n[e]={x:Number(r.attr("x")),y:Number(r.attr("y"))}});var i={top:this.popUnique([n.topLeft.y,n.topMiddle.y,n.topRight.y]),right:this.popUnique([n.topRight.x,n.rightMiddle.x,n.bottomRight.x]),bottom:this.popUnique([n.bottomLeft.y,n.bottomMiddle.y,n.bottomRight.y]),left:this.popUnique([n.topLeft.x,n.leftMiddle.x,n.bottomLeft.x])},o={topMiddle:(i.left+i.right)/2,rightMiddle:(i.top+i.bottom)/2,bottomMiddle:(i.left+i.right)/2,leftMiddle:(i.top+i.bottom)/2};a.forEach(function(n){if(e!==n){var a=n.split(r).map(function(e){return e.toLowerCase()});if("middle"===a[1])return"topMiddle"===n||"bottomMiddle"===n?(t.edges[n].attr("y",i[a[0]]),void t.edges[n].attr("x",o[n])):(t.edges[n].attr("y",o[n]),void t.edges[n].attr("x",i[a[0]]));t.edges[n].attr("y",i[a[0]]),t.edges[n].attr("x",i[a[1]])}})}},{key:"drag",value:function(e,t){var n=this.middleman(),r=this.layer,a=this.RADIUS,i=this.reattachHandles.bind(this),o=this.rearrangeHandles.bind(this),u=n[c["default"].DRAFT][c["default"].LAYERS].boundingBox,l=void 0,s=void 0,d=void 0;return{start:function(){n.boundingBox().bBox.remove(),n.preventDeselect(!0);var t=d3.select(this).classed("dragging",!0);return d=e.attr("width")/e.attr("height"),l=d3.event.sourceEvent.pageX-parseInt(t.attr("x")),s=d3.event.sourceEvent.pageY-parseInt(t.attr("y")),{x:l,y:s}},drag:function(){var i=n.options(),u=d3.select(this),d=d3.event.sourceEvent.pageX-l,c=d3.event.sourceEvent.pageY-s,f=Math.ceil(d/i.gridSize)*i.gridSize,h=Math.ceil(c/i.gridSize)*i.gridSize;"topMiddle"!==t&&"bottomMiddle"!==t&&u.attr("x",f),"rightMiddle"!==t&&"leftMiddle"!==t&&u.attr("y",h),o(t);var p=r.node().getBBox();return e.attr("x",p.x+a/2).attr("y",p.y+a/2).attr("height",p.height-a).attr("width",p.width-a),{x:f,y:h}},end:function(){n.boundingBox().drawBoundingBox(n.selected(),u),n.preventDeselect(!1),i()}}}}]),t}(s["default"]);n["default"]=f,t.exports=n["default"]},{"./../helpers/Symbols":13,"./Ability":3}],5:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var a=e,i=t,o=n;u=s=l=void 0,r=!1,null===a&&(a=Function.prototype);var u=Object.getOwnPropertyDescriptor(a,i);if(void 0!==u){if("value"in u)return u.value;var l=u.get;return void 0===l?void 0:l.call(o)}var s=Object.getPrototypeOf(a);if(null===s)return void 0;e=s,t=i,n=o,r=!0}},l=e("./Ability"),s=r(l),d=e("./../helpers/Symbols"),c=r(d),f=function(e){function t(){a(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return i(t,e),o(t,[{key:"didAdd",value:function(){var e=this,t=this.shape()[c["default"].ELEMENT];t.on("click",this.handleClick.bind(this)),t.call(d3.behavior.drag().on("drag",function(){return e.handleDrag()}))}},{key:"handleDrag",value:function(){this.handleClick();var e=this.shape()[c["default"].MIDDLEMAN];e.preventDeselect(!0);var t=new MouseEvent("mousedown",{bubbles:!0,cancelable:!1});t.overrideX=d3.event.sourceEvent.pageX,t.overrideY=d3.event.sourceEvent.pageY;var n=e.boundingBox().bBox.node();return n.dispatchEvent(t),t}},{key:"handleClick",value:function(){var e=this.middleman()[c["default"].KEY_MAP];return this.shape().isSelected()?e.multiSelect?void this.middleman().deselect({include:this.shape()}):void this.middleman().deselect({exclude:this.shape()}):(e.multiSelect||this.middleman().deselect({exclude:this.shape()}),void this.middleman().select({include:this.shape()}))}}]),t}(s["default"]);n["default"]=f,t.exports=n["default"]},{"./../helpers/Symbols":13,"./Ability":3}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(e,t,n){switch(t){case"x":var r=e.datum().y||0;return void e.attr("transform","translate("+n+", "+r+")");case"y":var a=e.datum().x||0;return void e.attr("transform","translate("+a+", "+n+")")}e.attr(t,n)},t.exports=n["default"]},{}],7:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("mousetrap"),l=r(u),s=e("./Symbols"),d=r(s),c=function(){function e(t){i(this,e),this[d["default"].MIDDLEMAN]=t,this.listenToKeyboardEvents()}return o(e,[{key:"listenToKeyboardEvents",value:function(){var e=this,t=function(t,n,r){"function"==typeof t.preventDefault&&t.preventDefault(),e.moveSelectedBy(n,r,!0)},n=this[d["default"].MIDDLEMAN].options(),r=n.defaultMoveStep,a=n.shiftMoveStep;l["default"].bind("left",function(e){return t(e,-r,0)}),l["default"].bind("right",function(e){return t(e,r,0)}),l["default"].bind("up",function(e){return t(e,0,-r)}),l["default"].bind("down",function(e){return t(e,0,r)}),l["default"].bind("shift+left",function(e){return t(e,-a,0)}),l["default"].bind("shift+right",function(e){return t(e,a,0)}),l["default"].bind("shift+up",function(e){return t(e,0,-a)}),l["default"].bind("shift+down",function(e){return t(e,0,a)})}},{key:"handleClick",value:function(){var e=this[d["default"].MIDDLEMAN];if(d3.event.stopPropagation(),e.preventDeselect())return void e.preventDeselect(!1);var t=d3.event.pageX,n=d3.event.pageY;this.bBox.attr("pointer-events","none");var r=document.elementFromPoint(t,n);if(this.bBox.attr("pointer-events","all"),e.fromElement(r)){var a=new MouseEvent("click",{bubbles:!0,cancelable:!1});r.dispatchEvent(a)}}},{key:"drawBoundingBox",value:function(e,t){var n,r,i,o=this;if(this.bBox&&this.bBox.remove(),0!==e.length){var u={minX:Number.MAX_VALUE,minY:Number.MAX_VALUE,maxX:Number.MIN_VALUE,maxY:Number.MIN_VALUE},l=function(e){u.minX=Math.min.apply(Math,a(e.map(function(e){return e.x}))),u.minY=Math.min.apply(Math,a(e.map(function(e){return e.y}))),u.maxX=Math.max.apply(Math,a(e.map(function(e){return e.x+e.width}))),u.maxY=Math.max.apply(Math,a(e.map(function(e){return e.y+e.height})))};l(e.map(function(e){return e.boundingBox()})),this.bBox=t.append("rect").datum(u).classed("drag-box",!0).attr("x",function(e){return e.minX}).attr("y",function(e){return e.minY}).attr("width",function(e){return e.maxX-e.minX}).attr("height",function(e){return e.maxY-e.minY}).on("click",this.handleClick.bind(this));var s=["dragstart",function(){return o.dragStart()}],d=["drag",function(){return o.drag()}],c=["dragend",function(){return o.dragEnd()}];this.bBox.call((n=(r=(i=d3.behavior.drag()).on.apply(i,s)).on.apply(r,d)).on.apply(n,c))}}},{key:"dragStart",value:function(){var e=void 0===arguments[0]?null:arguments[0],t=void 0===arguments[1]?null:arguments[1],n=Number(this.bBox.attr("x")),r=Number(this.bBox.attr("y"));this.start={x:null!==e?e:(d3.event.sourceEvent.overrideX||d3.event.sourceEvent.pageX)-n,y:null!==t?t:(d3.event.sourceEvent.overrideY||d3.event.sourceEvent.pageY)-r},this.move={start:{x:n,y:r},end:{}}}},{key:"drag",value:function(){var e=void 0===arguments[0]?null:arguments[0],t=void 0===arguments[1]?null:arguments[1],n=void 0===arguments[2]?this[d["default"].MIDDLEMAN].options().gridSize:arguments[2];this[d["default"].MIDDLEMAN].preventDeselect(!0),e=null!==e?e:d3.event.sourceEvent.pageX,t=null!==t?t:d3.event.sourceEvent.pageY;var r=e-this.start.x,a=t-this.start.y,i=Math.ceil(r/n)*n,o=Math.ceil(a/n)*n;this.bBox.datum().x=i,this.bBox.datum().y=o,this.bBox.attr("x",i),this.bBox.attr("y",o),this.move.end={x:i,y:o}}},{key:"dragEnd",value:function(){var e=this.move.end.x-this.move.start.x,t=this.move.end.y-this.move.start.y;isNaN(e)||isNaN(t)||this.moveSelectedBy(e,t)}},{key:"moveSelectedBy",value:function(e,t){var n=this,r=void 0===arguments[2]?!1:arguments[2];this[d["default"].MIDDLEMAN].selected().forEach(function(a){var i=a.attr("x"),o=a.attr("y"),u=i+e,l=o+t;a.attr("x",u).attr("y",l),a.attr("x",u).attr("y",l),a.didMove(),r&&(n.bBox.attr("x",u).attr("y",l),n.bBox.attr("x",u).attr("y",l))})}}]),e}();n["default"]=c,t.exports=n["default"]},{"./Symbols":13,mousetrap:1}],8:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var a=e("./Symbols"),i=r(a),o=function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;n>a;a++)r[a-2]=arguments[a];return"function"==typeof e[t]?(e[t].apply(e,r),!0):!1},u=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};n["default"]=function(){return{did:function(e,t){return t=Array.isArray(t)?t:[t],t.every(function(t){return o(t,"did"+u(e))})},includeExclude:function(e,t){var n=void 0===arguments[2]?{}:arguments[2],r=n.include||void 0,a=n.exclude||void 0,o=e[i["default"].MIDDLEMAN],u=function(e){return e=Array.isArray(e)?e:[e],o.all().filter(function(t){return!~e.indexOf(t)})};return r?void t.apply(e,[r]):a?void t.apply(e,[u(a)]):void t.apply(e)}}}(),t.exports=n["default"]},{"./Symbols":13}],9:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("mousetrap"),u=r(o),l=e("./Symbols"),s=r(l),d=function(){function e(t){a(this,e);var n=t[s["default"].KEY_MAP];this[s["default"].MIDDLEMAN]=t,n.multiSelect=!1,n.aspectRatio=!1,this.attachBindings(n)}return i(e,[{key:"attachBindings",value:function(e){var t=this;u["default"].bind("mod+a",function(){return t[s["default"].MIDDLEMAN].select()}),u["default"].bind("mod",function(){return e.multiSelect=!0},"keydown"),u["default"].bind("mod",function(){return e.multiSelect=!1},"keyup"),u["default"].bind("shift",function(){return e.aspectRatio=!0},"keydown"),u["default"].bind("shift",function(){return e.aspectRatio=!1},"keyup")}}]),e}();n["default"]=d,t.exports=n["default"]},{"./Symbols":13,mousetrap:1}],10:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var a=e("../helpers/Throw"),i=r(a),o=e("../shapes/Rectangle"),u=r(o);n["default"]=function(e){var t={rectangle:u["default"]};return"undefined"!=typeof t[e]?new t[e]:new i["default"]('Cannot map "'+e+'" to a shape object')},t.exports=n["default"]},{"../helpers/Throw":14,"../shapes/Rectangle":15}],11:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("./Symbols"),u=r(o),l=e("./KeyBindings"),s=r(l),d=e("./Invocator"),c=r(d),f=function(){function e(t){a(this,e),this[u["default"].DRAFT]=t,this[u["default"].KEY_MAP]={},this[u["default"].CAN_DESELECT]=!1,new s["default"](this)}return i(e,[{key:"d3",value:function(){return this[u["default"].DRAFT][u["default"].SVG]}},{key:"layers",value:function(){return this[u["default"].DRAFT][u["default"].LAYERS]}},{key:"options",value:function(){return this[u["default"].DRAFT].options()}},{key:"keyMap",value:function(){return this[u["default"].KEY_MAP]}},{key:"select",value:function(e){c["default"].includeExclude(this[u["default"].DRAFT],this[u["default"].DRAFT].select,e)}},{key:"deselect",value:function(e){c["default"].includeExclude(this[u["default"].DRAFT],this[u["default"].DRAFT].deselect,e)}},{key:"all",value:function(){return this[u["default"].DRAFT].all()}},{key:"selected",value:function(){return this[u["default"].DRAFT].selected()}},{key:"fromElement",value:function(e){return this.all().filter(function(t){return e===t[u["default"].ELEMENT].node()})[0]}},{key:"preventDeselect",value:function(e){return"undefined"==typeof e?this[u["default"].CAN_DESELECT]:void(this[u["default"].CAN_DESELECT]=e)}},{key:"boundingBox",value:function(){return this[u["default"].DRAFT][u["default"].BOUNDING_BOX]}}]),e}();n["default"]=f,t.exports=n["default"]},{"./Invocator":8,"./KeyBindings":9,"./Symbols":13}],12:[function(e,t,n){"use strict";function r(e){if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(void 0!==r&&null!==r){r=Object(r);for(var a=Object.keys(Object(r)),i=0,o=a.length;o>i;i++){var u=a[i],l=Object.getOwnPropertyDescriptor(r,u);void 0!==l&&l.enumerable&&(t[u]=r[u])}}}return t}Object.defineProperty(n,"__esModule",{value:!0}),n.objectAssign=r},{}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]={DRAFT:Symbol("draft"),SVG:Symbol("svg"),ELEMENT:Symbol("element"),IS_SELECTED:Symbol("isSelected"),ATTRIBUTES:Symbol("attributes"),MIDDLEMAN:Symbol("middleman"),SHAPE:Symbol("shape"),SHAPES:Symbol("shapes"),LAYERS:Symbol("layers"),GROUP:Symbol("group"),BOUNDING_BOX:Symbol("boundingBox"),OPTIONS:Symbol("options"),ABILITIES:Symbol("abilities"),KEY_MAP:Symbol("keyMap"),CAN_DESELECT:Symbol("canDeselect")},t.exports=n["default"]},{}],14:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function i(e){throw r(this,i),new Error("Draft.js: "+e+".")};n["default"]=a,t.exports=n["default"]},{}],15:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var a=e,i=t,o=n;u=s=l=void 0,r=!1,null===a&&(a=Function.prototype);var u=Object.getOwnPropertyDescriptor(a,i);if(void 0!==u){if("value"in u)return u.value;var l=u.get;return void 0===l?void 0:l.call(o)}var s=Object.getPrototypeOf(a);if(null===s)return void 0;e=s,t=i,n=o,r=!0}},l=e("./Shape"),s=r(l),d=function(e){function t(){a(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return i(t,e),o(t,[{key:"tagName",value:function(){return"rect"}},{key:"defaultAttributes",value:function(){return{fill:"blue",height:100,width:100,x:0,y:0}}}]),t}(s["default"]);n["default"]=d,t.exports=n["default"]},{"./Shape":16}],16:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("../helpers/Symbols"),u=r(o),l=e("../helpers/Throw"),s=r(l),d=e("../helpers/Polyfills"),c=e("../helpers/Attributes"),f=r(c),h=e("../helpers/Invocator"),p=r(h),v=e("../abilities/Selectable"),y=r(v),b=e("../abilities/Resizable"),m=r(b),g=function(){function e(){var t=void 0===arguments[0]?{}:arguments[0];a(this,e),this[u["default"].ATTRIBUTES]=t}return i(e,[{key:"tagName",value:function(){new s["default"]("Tag name must be defined for a shape using the `tagName` method")}},{key:"isSelected",value:function(){return this[u["default"].IS_SELECTED]}},{key:"attr",value:function(e,t){return"undefined"==typeof t?this[u["default"].ELEMENT].datum()[e]:(this[u["default"].ELEMENT].datum()[e]=t,f["default"](this[u["default"].ELEMENT],e,t),this)}},{key:"didAdd",value:function(){var e=this,t=this[u["default"].MIDDLEMAN].layers().shapes,n=d.objectAssign(this.defaultAttributes(),this[u["default"].ATTRIBUTES]);this[u["default"].GROUP]=t.append("g"),this[u["default"].ELEMENT]=this[u["default"].GROUP].append(this.tagName()).datum({}),Object.keys(n).forEach(function(t){return e.attr(t,n[t])});var r={selectable:new y["default"],resizable:new m["default"]};Object.keys(r).forEach(function(t){var n=r[t];n[u["default"].SHAPE]=e,p["default"].did("add",n)}),this[u["default"].ABILITIES]=r}},{key:"didRemove",value:function(){}},{key:"didMove",value:function(){this[u["default"].ABILITIES].resizable.reattachHandles()}},{key:"didSelect",value:function(){this[u["default"].IS_SELECTED]=!0,this[u["default"].ABILITIES].resizable.didSelect()}},{key:"didDeselect",value:function(){this[u["default"].IS_SELECTED]=!1,this[u["default"].ABILITIES].resizable.didDeselect()}},{key:"boundingBox",value:function(){var e="function"==typeof this[u["default"].GROUP].node().getBBox;return e?this[u["default"].GROUP].node().getBBox():{height:this.attr("height"),width:this.attr("width"),x:this.attr("x"),y:this.attr("y")}}},{key:"defaultAttributes",value:function(){return{}}}]),e}();n["default"]=g,t.exports=n["default"]},{"../abilities/Resizable":4,"../abilities/Selectable":5,"../helpers/Attributes":6,"../helpers/Invocator":8,"../helpers/Polyfills":12,"../helpers/Symbols":13,"../helpers/Throw":14}]},{},[2]);